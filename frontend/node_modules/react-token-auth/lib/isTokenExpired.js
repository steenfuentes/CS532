"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isTokenExpired = void 0;
exports.isTokenExpired = function (token, thresholdMillisec) {
    return isTimestampExpired(jwtExp(token), thresholdMillisec);
};
var jwtExp = function (token) {
    var split = token.split('.');
    if (split.length < 2) {
        return null;
    }
    try {
        var middlePart = Buffer.from(token.split('.')[1], 'base64').toString();
        var jwt = JSON.parse(middlePart);
        if (jwt && jwt.exp && Number.isFinite(jwt.exp)) {
            return jwt.exp * 1000;
        }
        else {
            return null;
        }
    }
    catch (e) {
        return null;
    }
};
var isTimestampExpired = function (exp, thresholdMillisec) {
    if (!exp) {
        return false;
    }
    return Date.now() > exp - (thresholdMillisec !== null && thresholdMillisec !== void 0 ? thresholdMillisec : 0);
};
